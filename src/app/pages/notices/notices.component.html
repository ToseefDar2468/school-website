<section class="space-y-8">
  <header>
    <app-section-header
      title="Notices"
      subtitle="Stay updated with the latest announcements, circulars, and school updates."
      [headingLevel]="1"
      titleClass="page-title"
      subtitleClass="page-subtitle"
      containerClass="space-y-2"
    />
  </header>

  <div class="grid gap-4 md:grid-cols-[1fr_auto]">
    <mat-form-field class="w-full">
      <mat-label>Search notices</mat-label>
      <input
        matInput
        type="search"
        placeholder="Search notices by title or description"
        [formControl]="searchControl"
      />
    </mat-form-field>

    <mat-form-field class="w-full md:w-56" appearance="outline">
      <mat-label>Filter</mat-label>
      <mat-select [formControl]="filterControl">
        @for (option of filterOptions; track option.value) {
          <mat-option [value]="option.value">{{ option.label }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
  </div>

  @if (vm$ | async; as vm) {
    @if (vm.pinned.length) {
      <section class="space-y-4">
        <div class="flex items-center justify-between">
          <h2 class="section-title">Pinned notices</h2>
          <app-badge label="Pinned" variant="pinned"></app-badge>
        </div>

        <div class="grid gap-4 md:grid-cols-2">
          @for (notice of vm.pinned; track notice.id) {
            <article class="card card-hover space-y-3">
              <div class="flex flex-wrap items-center gap-2 text-xs text-text-muted">
                <span>{{ notice.dateISO | date: 'mediumDate' }}</span>
                <app-badge label="Pinned" variant="pinned"></app-badge>
              </div>
              <h3 class="text-lg font-semibold text-text">{{ notice.title }}</h3>
              <p class="text-sm text-text-muted">{{ excerpt(notice.description) }}</p>
              <a class="link text-sm font-semibold" [routerLink]="['/notices', notice.id]">
                Read more
              </a>
            </article>
          }
        </div>
      </section>
    }

    <section class="space-y-4">
      <h2 class="section-title">All notices</h2>

      @if (vm.regular.length) {
        <div class="grid gap-4 md:grid-cols-2">
          @for (notice of vm.regular; track notice.id) {
            <article class="card card-hover space-y-3">
              <div class="flex flex-wrap items-center gap-2 text-xs text-text-muted">
                <span>{{ notice.dateISO | date: 'mediumDate' }}</span>
              </div>
              <h3 class="text-lg font-semibold text-text">{{ notice.title }}</h3>
              <p class="text-sm text-text-muted">{{ excerpt(notice.description) }}</p>
              <a class="link text-sm font-semibold" [routerLink]="['/notices', notice.id]">
                Read more
              </a>
            </article>
          }
        </div>
      } @else {
        <div class="card space-y-2 text-sm text-text-muted">
          <p>No notices match your search and filter selection.</p>
          <p>Try clearing the search or switching filters.</p>
        </div>
      }
    </section>
  }
</section>
